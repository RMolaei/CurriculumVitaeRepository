% Information Template, LaTeX Package
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{informationTemplate}

\RequirePackage{./../lib/commonPackages}

\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=teal,
%   pdftitle={Overleaf Example},
%   pdfpagemode=FullScreen,
}

\setitemize{
  topsep=0cm,
  partopsep=0cm,
  parsep=0cm,
  itemsep=0cm
}

\setlength{\parindent}{2mm}


% Date
\newcommand{\dateEP}[2]{\iftoggle{EnglishToggle}{#1}{}\iftoggle{PersianToggle}{#2}{}}


% Email
\newcommand{\email}[1]{\iftoggle{EnglishToggle}{\href{mailto: #1}{#1}}{}\iftoggle{PersianToggle}{\lr{\href{mailto: #1}{#1}}}{}}


% Phone
\newcommand{\phone}[2]{\iftoggle{EnglishToggle}{\href{tel: #1}{#1}}{}\iftoggle{PersianToggle}{\href{tel: #2}{#2}}{}}


% Name
\newcommand{\firstNameCE}[1]{\newcommand{\firstNameE}{#1\xspace}}
\newcommand{\lastNameCE}[1]{\newcommand{\lastNameE}{#1\xspace}}
\newcommand{\firstNameCP}[1]{\newcommand{\firstNameP}{#1\xspace}}
\newcommand{\lastNameCP}[1]{\newcommand{\lastNameP}{#1\xspace}}

\newcommand{\firstName}{\iftoggle{EnglishToggle}{\firstNameE}{}\iftoggle{PersianToggle}{\firstNameP}{}}
\newcommand{\lastName}{\iftoggle{EnglishToggle}{\lastNameE}{}\iftoggle{PersianToggle}{\lastNameP}{}}
\newcommand{\fullName}{\iftoggle{EnglishToggle}{\firstName \lastName}{}\iftoggle{PersianToggle}{\firstName \lastName}{}}

% Born Data
\newcommand{\bornDataC}[3]{\newcommand{\bornData}{\iftoggle{EnglishToggle}
{\iftoggle{CurriculumVitae}{#3 #1\xspace}{}\iftoggle{Resume}{#3\xspace}{}}
{}\iftoggle{PersianToggle}
{\iftoggle{CurriculumVitae}{#3 #2\xspace}{}\iftoggle{Resume}{#3\xspace}{}}{}}}

% Marital StateCE
\newcommand{\maritalStateCE}[1]{\newcommand{\maritalStateE}{#1\xspace}}
\newcommand{\maritalStateCP}[1]{\newcommand{\maritalStateP}{#1\xspace}}

\newcommand{\maritalState}{\iftoggle{EnglishToggle}{\maritalStateE}{}\iftoggle{PersianToggle}{\maritalStateP}{}}

% Military service
\newcommand{\militaryServiceCE}[1]{\newcommand{\militaryServiceE}{#1\xspace}}
\newcommand{\militaryServiceCP}[1]{\newcommand{\militaryServiceP}{#1\xspace}}

\newcommand{\militaryService}{\iftoggle{EnglishToggle}{\militaryServiceE}{}\iftoggle{PersianToggle}{\militaryServiceP}{}}


% Address
\newcommand{\addressE}[2]{\iftoggle{CurriculumVitae}{#2, #1}{}\iftoggle{Resume}{#1}{}}
\newcommand{\addressP}[2]{\iftoggle{CurriculumVitae}{#1, #2}{}\iftoggle{Resume}{#1}{}}


% Contact Information
\newcommand{\fullAddressC}[3]{\newcommand{\fullAddress}{\iftoggle{EnglishToggle}{#1}{}\iftoggle{PersianToggle}{#2}{}\iftoggle{CurriculumVitae}{\iftoggle{EnglishToggle}{, Postal code:}{}\iftoggle{PersianToggle}{, کدپستی:}{} #3\xspace}{}}}

\newcommand{\mobilePhoneIC}[1]{\newcommand{\mobilePhoneI}{#1\xspace}}
\newcommand{\mobilePhoneIIC}[1]{\newcommand{\mobilePhoneII}{#1\xspace}}

\newcommand{\phoneNumberC}[1]{\newcommand{\phoneNumber}{#1\xspace}}

\newcommand{\emailIC}[1]{\newcommand{\emailI}{#1\xspace}}
\newcommand{\emailIIC}[1]{\newcommand{\emailII}{#1\xspace}}

\newcommand{\skypeC}[1]{\newcommand{\skype}{\iftoggle{EnglishToggle}{\href{skypeto: #1}{#1}}{}\iftoggle{PersianToggle}{\lr{\href{skypeto: #1}{#1}}}{}}}

\newcommand{\gitHubC}[1]{\newcommand{\gitHub}{\url{#1}}}

\newcommand{\linkedinC}[1]{\newcommand{\linkedin}{\url{#1}}}


% Profession
\newcommand{\ProfessionIC}[2]{\newcommand{\ProfessionI}{\iftoggle{EnglishToggle}{#1}{}\iftoggle{PersianToggle}{#2}{}}}
\newcommand{\ProfessionIIC}[2]{\newcommand{\ProfessionII}{\iftoggle{EnglishToggle}{#1}{}\iftoggle{PersianToggle}{#2}{}}}


% Descriptions
\newcommand{\aboutCE}[1]{\newcommand{\aboutE}{#1\xspace}}
\newcommand{\summaryCE}[1]{\newcommand{\summaryE}{#1\xspace}}
\newcommand{\aboutCP}[1]{\newcommand{\aboutP}{#1\xspace}}
\newcommand{\summaryCP}[1]{\newcommand{\summaryP}{#1\xspace}}

\newcommand{\descriptionsE}{\iftoggle{CurriculumVitae}{\section*{About}\aboutE}{}\iftoggle{Resume}{\section*{Summary}\summaryE}{}}
\newcommand{\descriptionsP}{\iftoggle{CurriculumVitae}{\section*{درباره}\aboutP}{}\iftoggle{Resume}{\section*{خلاصه}\summaryP}{}}
\newcommand{\descriptions}{\iftoggle{EnglishToggle}{\descriptionsE}{}\iftoggle{PersianToggle}{\descriptionsP}{}}


% Acronym
\newcommand{\acronymE}[3]{\iftoggle{#3}{#2\xspace}{#1\acronymlistC{#1}{#2}{#3}\toggletrue{#3} (#2)\xspace}}
\newcommand{\acronymP}[3]{\iftoggle{#3}{#2\xspace}{#1\acronymlistC{#1}{#2}{#3}\toggletrue{#3} (#2)\xspace}}

\newcommand{\acronymC}[5]{\expandafter\newcommand\csname #5\endcsname
{\iftoggle{EnglishToggle}{\acronymE{#1}{#2}{#5}}{}\iftoggle{PersianToggle}{\acronymP{#3}{#4}{#5}}{}}
\newtoggle{#5}}

\newcommand{\acronymlist}{\iftoggle{EnglishToggle}{List of abbreviations and acronyms:}{}\iftoggle{PersianToggle}{فهرست اختصارات و کلمات اختصاری:}{}}
\newcommand{\acronymlistC}[3]{\expandafter\let\csname acronymlistbefore#3\endcsname\acronymlist
\renewcommand{\acronymlist}{\expandafter\csname acronymlistbefore#3\endcsname \\\iftoggle{EnglishToggle}{#1 #2}{}\iftoggle{PersianToggle}{#1 #2}{}}}


% Institute
\newcommand{\instituteE}[5]{\iftoggle{CurriculumVitae}{\iftoggle{#5}
{\parbox{150mm}{\raggedright\Large\bfseries\color{blue}#1}\quad\quad\parbox{34mm}{\ResumeText\centering#3\CVText\\\url{#4}}}
{\parbox{45mm}{\raggedright\Large\bfseries\color{blue}#1}\quad\parbox{142mm}{#2 #3, \url{#4}}\toggletrue{#5}}}
{}\iftoggle{Resume}
{\parbox{150mm}{\raggedright\Large\bfseries\color{blue}#1}\quad\quad\parbox{34mm}{\centering#3\\\url{#4}}}{}}
\newcommand{\instituteP}[5]{\iftoggle{CurriculumVitae}{\iftoggle{#5}
{\parbox{150mm}{\raggedleft\Large\bfseries\color{blue}#1}\quad\quad\parbox{34mm}{\ResumeText\centering#3\CVText\\\url{#4}}}
{\parbox{45mm}{\raggedleft\Large\bfseries\color{blue}#1}\quad\parbox{142mm}{#2 #3, \url{#4}}\toggletrue{#5}}}
{}\iftoggle{Resume}
{\parbox{150mm}{\raggedleft\Large\bfseries\color{blue}#1}\quad\quad\parbox{34mm}{\centering#3\\\url{#4}}}{}}

\newcommand{\instituteC}[8]{\newtoggle{#8}
\expandafter\newcommand\csname #8\endcsname
{\iftoggle{EnglishToggle}{\instituteE{#1}{#2}{#3}{#7}{#8}}{}\iftoggle{PersianToggle}{\instituteP{#4}{#5}{#6}{#7}{#8}}{}}
}


% Types of employment
\newcommand{\fulltime}{\iftoggle{EnglishToggle}{Full time}{}\iftoggle{PersianToggle}{تمام وقت}{}}
\newcommand{\parttime}{\iftoggle{EnglishToggle}{Part time}{}\iftoggle{PersianToggle}{پاره وقت}{}}


% Cooperation period
\newcounter{jobPositionindex}\setcounter{jobPositionindex}{0}
\newcounter{maxjobPositionindex}\setcounter{maxjobPositionindex}{3}
\newcommand{\cooperationPeriodC}[2]{\expandafter\newcommand\csname #2\endcsname{#1}\newcounter{#2}\setcounter{#2}{0}}


% Job position
\newcommand{\jobPositionE}[6]{\colorbox{gray}
{\bfseries\color{white}\parbox{85mm}{#1}\parbox{29mm}{\centering#3}\parbox{75mm}{\raggedleft#4 to #5}}\\#2}
\newcommand{\jobPositionP}[6]{\colorbox{gray}
{\bfseries\color{white}\parbox{85mm}{\ #1}\parbox{29mm}{\centering#3}\parbox{75mm}{\raggedright#4 الی #5}}\\#2}

\newcommand{\jobPositionC}[8]{\ifthenelse{\value{#8}=0}
{\expandafter\newcommand\csname jobPosition\arabic{jobPositionindex}\endcsname
{\csname #8\endcsname\\\iftoggle{EnglishToggle}
{\jobPositionE{#1}{#2}{#5}{#6}{#7}{#8}}{}\iftoggle{PersianToggle}
{\jobPositionP{#3}{#4}{#5}{#6}{#7}{#8}}{}}}
{\expandafter\newcommand\csname jobPosition\arabic{jobPositionindex}\endcsname
{\iftoggle{EnglishToggle}
{\jobPositionE{#1}{#2}{#5}{#6}{#7}{#8}}{}\iftoggle{PersianToggle}
{\jobPositionP{#3}{#4}{#5}{#6}{#7}{#8}}{}}}
\addtocounter{#8}{1}\addtocounter{jobPositionindex}{1}}


% Work Experience
\newcommand{\workExperienceListC}{\iftoggle{CurriculumVitae}
{\newcounter{JPjndex}\forloop{JPjndex}{0}{\value{JPjndex} < \value{jobPositionindex}}{\noindent\csname jobPosition\arabic{JPjndex}\endcsname\par}}{}\iftoggle{Resume}
{\newcounter{JPkndex}\forloop{JPkndex}{0}{\value{JPkndex} < \value{maxjobPositionindex} \and \value{JPkndex} < \value{jobPositionindex}}{\noindent\csname jobPosition\arabic{JPkndex}\endcsname\par}}{}}
\newcommand{\workExperience}{\iftoggle{EnglishToggle}{\section*{Work Experience}}{}\iftoggle{PersianToggle}{\section*{سوابق کاری}}{}\workExperienceListC}


% Education period
\newcounter{educationGradeindex}\setcounter{educationGradeindex}{0}
\newcounter{maxeducationGradeindex}\setcounter{maxeducationGradeindex}{2}
\newcommand{\educationPeriodC}[2]{\expandafter\newcommand\csname #2\endcsname{#1}\newcounter{#2}\setcounter{#2}{0}}


% Education grade
\newcommand{\educationGradeE}[9]{\parbox{190mm}{\colorbox{brown}
{\bfseries\color{white}\parbox{85mm}{#1 in #2}\parbox{29mm}{\centering#5}\parbox{75mm}{\raggedleft#6 to #7}}\\
{\bfseries\color{darkgray}\ \parbox{85mm}{Minor: #3}\parbox{29mm}{\centering GPA: #8}\parbox{75mm}{\raggedleft#4}}}\\}
\newcommand{\educationGradeP}[9]{\parbox{190mm}{\colorbox{brown}
{\bfseries\color{white}\parbox{85mm}{\ #1 #2}\parbox{29mm}{\centering#5}\parbox{75mm}{\raggedright#6 الی #7}}\\
{\bfseries\color{darkgray}\parbox{85mm}{گرایش: #3}\parbox{29mm}{\centering معدل: #8}\parbox{75mm}{\raggedright#4}}}\\}

\newcommand{\educationGradeCI}[9]{
\expandafter\def\csname tempa\arabic{educationGradeindex}\endcsname{#1}
\expandafter\def\csname tempb\arabic{educationGradeindex}\endcsname{#2}
\expandafter\def\csname tempc\arabic{educationGradeindex}\endcsname{#3}
\expandafter\def\csname tempd\arabic{educationGradeindex}\endcsname{#4}
\expandafter\def\csname tempe\arabic{educationGradeindex}\endcsname{#5}
\expandafter\def\csname tempf\arabic{educationGradeindex}\endcsname{#6}
\expandafter\def\csname tempg\arabic{educationGradeindex}\endcsname{#7}
\expandafter\def\csname temph\arabic{educationGradeindex}\endcsname{#8}}
\newcommand{\educationGradeCII}[7]{
\expandafter\def\csname tempi\arabic{educationGradeindex}\endcsname{#1}
\expandafter\def\csname tempj\arabic{educationGradeindex}\endcsname{#2}
\expandafter\def\csname tempk\arabic{educationGradeindex}\endcsname{#3}
\expandafter\def\csname templ\arabic{educationGradeindex}\endcsname{#4}
\expandafter\def\csname tempm\arabic{educationGradeindex}\endcsname{#5}
\expandafter\def\csname tempn\arabic{educationGradeindex}\endcsname{#6}
\educationGradeC{#7}}

\newcommand{\educationGradeC}[1]{\ifthenelse{\value{#1}=0}
{\expandafter\newcommand\csname educationGrade\arabic{educationGradeindex}\endcsname[1]
{\csname #1\endcsname\\\iftoggle{EnglishToggle}{\educationGradeE
{\csname tempa\arabic{##1}\endcsname}
{\csname tempb\arabic{##1}\endcsname}
{\csname tempc\arabic{##1}\endcsname}
{\csname tempd\arabic{##1}\endcsname}
{\csname tempk\arabic{##1}\endcsname}
{\csname templ\arabic{##1}\endcsname}
{\csname tempm\arabic{##1}\endcsname}
{\csname tempn\arabic{##1}\endcsname}
{#1}\csname tempi\arabic{##1}\endcsname}{}
\iftoggle{PersianToggle}{\educationGradeP
{\csname tempe\arabic{##1}\endcsname}
{\csname tempf\arabic{##1}\endcsname}
{\csname tempg\arabic{##1}\endcsname}
{\csname temph\arabic{##1}\endcsname}
{\csname tempk\arabic{##1}\endcsname}
{\csname templ\arabic{##1}\endcsname}
{\csname tempm\arabic{##1}\endcsname}
{\csname tempn\arabic{##1}\endcsname}
{#1}\csname tempj\arabic{##1}\endcsname}{}}}
{\expandafter\newcommand\csname educationGrade\arabic{educationGradeindex}\endcsname[1]
{\iftoggle{EnglishToggle}{\educationGradeE
{\csname tempa\arabic{##1}\endcsname}
{\csname tempb\arabic{##1}\endcsname}
{\csname tempc\arabic{##1}\endcsname}
{\csname tempd\arabic{##1}\endcsname}
{\csname tempk\arabic{##1}\endcsname}
{\csname templ\arabic{##1}\endcsname}
{\csname tempm\arabic{##1}\endcsname}
{\csname tempn\arabic{##1}\endcsname}
{#1}\csname tempi\arabic{##1}\endcsname}{}
\iftoggle{PersianToggle}{\educationGradeP
{\csname tempe\arabic{##1}\endcsname}
{\csname tempf\arabic{##1}\endcsname}
{\csname tempg\arabic{##1}\endcsname}
{\csname temph\arabic{##1}\endcsname}
{\csname tempk\arabic{##1}\endcsname}
{\csname templ\arabic{##1}\endcsname}
{\csname tempm\arabic{##1}\endcsname}
{\csname tempn\arabic{##1}\endcsname}
{#1}\csname tempj\arabic{##1}\endcsname}{}}}
\addtocounter{#1}{1}\addtocounter{educationGradeindex}{1}}


% Education
\newcommand{\educationListC}{\iftoggle{CurriculumVitae}
{\newcounter{EGjndex}\forloop{EGjndex}{0}{\value{EGjndex} < \value{educationGradeindex}}{\noindent\csname educationGrade\arabic{EGjndex}\endcsname{EGjndex}\par}}{}\iftoggle{Resume}
{\newcounter{EGkndex}\forloop{EGkndex}{0}{\value{EGkndex} < \value{maxeducationGradeindex} \and \value{EGkndex} < \value{educationGradeindex}}{\noindent\csname educationGrade\arabic{EGkndex}\endcsname{EGkndex}\par}}{}}
\newcommand{\education}{\iftoggle{EnglishToggle}{\section*{Education}}{}\iftoggle{PersianToggle}{\section*{سوابق تحصیلی}}{}\educationListC}


% GPA
\newcommand{\gpa}[2]{\iftoggle{EnglishToggle}{#1/#2}{}\iftoggle{PersianToggle}{$#1$ از $#2$}{}}


% Language
\newcounter{languageindex}\setcounter{languageindex}{0}
\newcounter{maxlanguageindex}\setcounter{maxlanguageindex}{3}
\newcommand{\languageC}[9]{\expandafter\newcommand\csname language\arabic{languageindex}\endcsname
{\iftoggle{EnglishToggle}{\languageE{#1}{#2}{#5}{#6}{#7}{#8}{#9}}{}\iftoggle{PersianToggle}{\languageP{#3}{#4}{#5}{#6}{#7}{#8}{#9}}{}}\addtocounter{languageindex}{1}}

\newcommand{\languageTitle}{\iftoggle{EnglishToggle}
{\parbox{189mm}{\colorbox{pink}
{\bfseries\color{darkgray}\parbox{27mm}{Language}\parbox{27mm}{Certification}\parbox{108mm}{\parbox{108mm}{\centering Skill}\\\parbox{108mm}{\parbox{27mm}{\centering Reading}\parbox{27mm}{\centering Writing}\parbox{27mm}{\centering Speaking}\parbox{27mm}{\centering Listening}}}\parbox{27mm}{Grade}}}}
{}\iftoggle{PersianToggle}{\ \parbox{189mm}{\colorbox{pink}
{\bfseries\color{darkgray}\parbox{27mm}{\ زبان}\parbox{27mm}{\ مدرک}\parbox{108mm}{\parbox{108mm}{\centering مهارت}\\\parbox{108mm}{\parbox{27mm}{\centering\ خوانشی}\parbox{27mm}{\centering\ نگارشی}\parbox{27mm}{\centering\ گفتاری}\parbox{27mm}{\centering\ شنیداری}}}\parbox{27mm}{\ نمره از کل}}}}{}}
\newcommand{\languageE}[7]{\iftoggle{CurriculumVitae}
{\parbox{28mm}{\ #1}\parbox{27mm}{\ #2}\parbox{27mm}{\centering\ #3}\parbox{27mm}{\centering\ #4}\parbox{27mm}{\centering\ #5}\parbox{27mm}{\centering\ #6}\parbox{27mm}{\ #7}}
{}\iftoggle{Resume}{#1 (#7)}{}}
\newcommand{\languageP}[7]{\iftoggle{CurriculumVitae}
{\parbox{28mm}{#1}\parbox{27mm}{#2}\parbox{27mm}{\centering#3}\parbox{27mm}{\centering#4}\parbox{27mm}{\centering#5}\parbox{27mm}{\centering#6}\parbox{27mm}{#7}}
{}\iftoggle{Resume}{#1 (#7)}{}}

\newcommand{\languagelistC}{\iftoggle{CurriculumVitae}
{\noindent\languageTitle\par\newcounter{languagejndex}\forloop{languagejndex}{0}{\value{languagejndex} < \value{languageindex}}{\noindent\csname language\arabic{languagejndex}\endcsname\par}}{}\iftoggle{Resume}
{\newcounter{languagekndex}\newcounter{languagelndex}\forloop{languagekndex}{0}{\value{languagekndex} < \value{maxlanguageindex} \and \value{languagekndex} < \value{languageindex}}{\noindent\csname language\arabic{languagekndex}\endcsname\addtocounter{languagelndex}{1}\ifthenelse{\value{languagelndex}<\value{maxlanguageindex} \and \value{languagelndex} < \value{languageindex}}{,\ }{}}}{}}
\newcommand{\languageS}{\iftoggle{EnglishToggle}{\section*{Languages}}{}\iftoggle{PersianToggle}{\section*{زبان‌های خارجی}}{}\languagelistC}


% Craft
\newcounter{craftindex}\setcounter{craftindex}{0}
\newcounter{maxcraftindex}\setcounter{maxcraftindex}{3}
\newcommand{\craftC}[7]{\expandafter\newcommand\csname craft\arabic{craftindex}\endcsname
{\iftoggle{EnglishToggle}{\craftE{#1}{#2}{#3}{#7}}{}\iftoggle{PersianToggle}{\craftP{#4}{#5}{#6}{#7}}{}}\addtocounter{craftindex}{1}}

\newcommand{\craftE}[4]{\iftoggle{CurriculumVitae}{\parbox{190mm}{\colorbox{olive}
{\bfseries\color{white}\parbox{114mm}{#1}\parbox{75mm}{\raggedleft#4}}\\
{\parbox{75mm}{#2}\quad\parbox{111mm}{#3}}}}{}\iftoggle{Resume}{\parbox{190mm}{\colorbox{olive}
{\bfseries\color{white}\parbox{189mm}{\centering#1}}\\
{\parbox{75mm}{#2}\quad\parbox{111mm}{#3}}}}{}}
\newcommand{\craftP}[4]{\iftoggle{CurriculumVitae}{\parbox{190mm}{\colorbox{olive}
{\bfseries\color{white}\parbox{114mm}{\ #1}\parbox{75mm}{\raggedright#4}}\\
{\parbox{75mm}{#2}\quad\parbox{111mm}{#3}}}}{}\iftoggle{Resume}
{\parbox{190mm}{\colorbox{olive}
{\bfseries\color{white}\parbox{189mm}{\centering#1}}\\
{\parbox{75mm}{#2}\quad\parbox{111mm}{#3}}}}{}}

\newcommand{\craftlistC}{\iftoggle{CurriculumVitae}
{\newcounter{craftjndex}\forloop{craftjndex}{0}{\value{craftjndex} < \value{craftindex}}{\noindent\csname craft\arabic{craftjndex}\endcsname\par}}{}\iftoggle{Resume}
{\newcounter{craftkndex}\forloop{craftkndex}{0}{\value{craftkndex} < \value{maxcraftindex} \and \value{craftkndex} < \value{craftindex}}{\noindent\csname craft\arabic{craftkndex}\endcsname\par}
\noindent\parbox{190mm}{\colorbox{olive}
{\bfseries\color{white}\parbox{189mm}{\centering\iftoggle{EnglishToggle}{Language}{}\iftoggle{PersianToggle}{زبان}{}}}\\\languagelistC}\par}{}}
\newcommand{\craft}{\iftoggle{EnglishToggle}{\section*{Craft}}{}\iftoggle{PersianToggle}{\section*{تخصص‌ها}}{}\craftlistC}


% Voluntary Cooperation period
\newcounter{voluntaryPositionindex}\setcounter{voluntaryPositionindex}{0}
\newcommand{\voluntaryCooperationPeriodC}[2]{\expandafter\newcommand\csname #2\endcsname{#1}\newcounter{#2}\setcounter{#2}{0}}


% Voluntary position
\newcommand{\voluntaryPositionE}[6]{\colorbox{green}
{\bfseries\color{darkgray}\parbox{85mm}{#1}\parbox{29mm}{\centering#3}\parbox{75mm}{\raggedleft#4 to #5}}\\#2}
\newcommand{\voluntaryPositionP}[6]{\colorbox{green}
{\bfseries\color{darkgray}\parbox{85mm}{\ #1}\parbox{29mm}{\centering#3}\parbox{75mm}{\raggedright#4 الی #5}}\\#2}

\newcommand{\voluntaryPositionC}[8]{\ifthenelse{\value{#8}=0}
{\expandafter\newcommand\csname voluntaryPosition\arabic{voluntaryPositionindex}\endcsname
{\csname #8\endcsname\\\iftoggle{EnglishToggle}
{\voluntaryPositionE{#1}{#2}{#5}{#6}{#7}{#8}}{}\iftoggle{PersianToggle}
{\voluntaryPositionP{#3}{#4}{#5}{#6}{#7}{#8}}{}}}
{\expandafter\newcommand\csname voluntaryPosition\arabic{voluntaryPositionindex}\endcsname
{\iftoggle{EnglishToggle}
{\voluntaryPositionE{#1}{#2}{#5}{#6}{#7}{#8}}{}\iftoggle{PersianToggle}
{\voluntaryPositionP{#3}{#4}{#5}{#6}{#7}{#8}}{}}}
\addtocounter{#8}{1}\addtocounter{voluntaryPositionindex}{1}}


% Voluntary
\newcommand{\voluntaryListC}{\iftoggle{CurriculumVitae}
{\newcounter{VPjndex}\forloop{VPjndex}{0}{\value{VPjndex} < \value{voluntaryPositionindex}}{\noindent\csname voluntaryPosition\arabic{VPjndex}\endcsname\par}}{}}
\newcommand{\voluntary}{\iftoggle{EnglishToggle}{\section*{Voluntary}}{}\iftoggle{PersianToggle}{\section*{فعالیت‌های داوطلبانه}}{}\voluntaryListC}


% Project
\newcounter{projectindex}\setcounter{projectindex}{0}
\newcounter{maxprojectindex}\setcounter{maxprojectindex}{3}
\newcommand{\projectC}[4]{\expandafter\newcommand\csname project\arabic{projectindex}\endcsname
{\iftoggle{EnglishToggle}{\projectE{#1}{#2}}{}\iftoggle{PersianToggle}{\projectP{#3}{#4}}{}}\addtocounter{projectindex}{1}}

\newcommand{\projectE}[2]{{\bfseries#1}: #2}
\newcommand{\projectP}[2]{{\bfseries#1}: #2}

\newcommand{\projectlistC}{\iftoggle{CurriculumVitae}
{\newcounter{projectjndex}\forloop{projectjndex}{0}{\value{projectjndex} < \value{projectindex}}{\csname project\arabic{projectjndex}\endcsname\par}}{}\iftoggle{Resume}
{\newcounter{projectkndex}\forloop{projectkndex}{0}{\value{projectkndex} < \value{maxprojectindex} \and \value{projectkndex} < \value{projectindex}}{\csname project\arabic{projectkndex}\endcsname\par}}{}}
\newcommand{\project}{\iftoggle{EnglishToggle}{\section*{Projects}}{}\iftoggle{PersianToggle}{\section*{پروژه‌ها}}{}\projectlistC}


% Professional training institute
\newcounter{PTindex}\setcounter{PTindex}{0}
\newcounter{maxPTindex}\setcounter{maxPTindex}{3}
\newcommand{\professionalTrainingInstituteC}[2]{\expandafter\newcommand\csname #2\endcsname{#1}\newcounter{#2}\setcounter{#2}{0}}


% Professional training
\newcommand{\professionalTrainingE}[8]{\parbox{190mm}{\colorbox{lime}
{\bfseries\color{darkgray}\parbox{114mm}{#1}\parbox{75mm}{\raggedleft#4 to #5}}\\
{\bfseries\color{darkgray}\ \parbox{85mm}{Lecturer: #2}\parbox{29mm}{\centering Score: #6}\parbox{75mm}{\raggedleft#3}}}\iftoggle{CurriculumVitae}
{\\#7}{}}
\newcommand{\professionalTrainingP}[8]{\parbox{190mm}{\colorbox{lime}
{\bfseries\color{darkgray}\parbox{114mm}{\ #1}\parbox{75mm}{\raggedright#4 الی #5}}\\
{\bfseries\color{darkgray}\parbox{85mm}{مدرس: #2}\parbox{29mm}{\centering نمره: #6}\parbox{75mm}{\raggedright#3}}}\iftoggle{CurriculumVitae}
{\\#7}{}}

\newcommand{\professionalTrainingCI}[9]{
\expandafter\def\csname tempPTa\arabic{PTindex}\endcsname{#1}
\expandafter\def\csname tempPTb\arabic{PTindex}\endcsname{#2}
\expandafter\def\csname tempPTc\arabic{PTindex}\endcsname{#3}
\expandafter\def\csname tempPTd\arabic{PTindex}\endcsname{#4}
\expandafter\def\csname tempPTe\arabic{PTindex}\endcsname{#5}
\expandafter\def\csname tempPTf\arabic{PTindex}\endcsname{#6}
\expandafter\def\csname tempPTg\arabic{PTindex}\endcsname{#7}
\expandafter\def\csname tempPTh\arabic{PTindex}\endcsname{#8}}
\newcommand{\professionalTrainingCII}[4]{
\expandafter\def\csname tempPTi\arabic{PTindex}\endcsname{#1}
\expandafter\def\csname tempPTj\arabic{PTindex}\endcsname{#2}
\expandafter\def\csname tempPTk\arabic{PTindex}\endcsname{#3}
\professionalTrainingC{#4}}

\newcommand{\professionalTrainingC}[1]{\ifthenelse{\value{#1}=0}
{\expandafter\newcommand\csname professionalTraining\arabic{PTindex}\endcsname[1]
{\csname #1\endcsname\\\iftoggle{EnglishToggle}{\professionalTrainingE
{\csname tempPTa\arabic{##1}\endcsname}
{\csname tempPTb\arabic{##1}\endcsname}
{\csname tempPTc\arabic{##1}\endcsname}
{\csname tempPTi\arabic{##1}\endcsname}
{\csname tempPTj\arabic{##1}\endcsname}
{\csname tempPTk\arabic{##1}\endcsname}
{\csname tempPTd\arabic{##1}\endcsname}
{#1}}{}
\iftoggle{PersianToggle}{\professionalTrainingP
{\csname tempPTe\arabic{##1}\endcsname}
{\csname tempPTf\arabic{##1}\endcsname}
{\csname tempPTg\arabic{##1}\endcsname}
{\csname tempPTi\arabic{##1}\endcsname}
{\csname tempPTj\arabic{##1}\endcsname}
{\csname tempPTk\arabic{##1}\endcsname}
{\csname tempPTh\arabic{##1}\endcsname}
{#1}}{}}}
{\expandafter\newcommand\csname professionalTraining\arabic{PTindex}\endcsname[1]
{\iftoggle{EnglishToggle}{\professionalTrainingE
{\csname tempPTa\arabic{##1}\endcsname}
{\csname tempPTb\arabic{##1}\endcsname}
{\csname tempPTc\arabic{##1}\endcsname}
{\csname tempPTi\arabic{##1}\endcsname}
{\csname tempPTj\arabic{##1}\endcsname}
{\csname tempPTk\arabic{##1}\endcsname}
{\csname tempPTd\arabic{##1}\endcsname}
{#1}}{}
\iftoggle{PersianToggle}{\professionalTrainingP
{\csname tempPTe\arabic{##1}\endcsname}
{\csname tempPTf\arabic{##1}\endcsname}
{\csname tempPTg\arabic{##1}\endcsname}
{\csname tempPTi\arabic{##1}\endcsname}
{\csname tempPTj\arabic{##1}\endcsname}
{\csname tempPTk\arabic{##1}\endcsname}
{\csname tempPTh\arabic{##1}\endcsname}
{#1}}{}}}
\addtocounter{#1}{1}\addtocounter{PTindex}{1}}


% Training
\newcommand{\professionalTrainingListC}{\iftoggle{CurriculumVitae}
{\newcounter{PTIjndex}\forloop{PTIjndex}{0}{\value{PTIjndex} < \value{PTindex}}{\noindent\csname professionalTraining\arabic{PTIjndex}\endcsname{PTIjndex}\par}}{}\iftoggle{Resume}
{\newcounter{PTIkndex}\forloop{PTIkndex}{0}{\value{PTIkndex} < \value{maxPTindex} \and \value{PTIkndex} < \value{PTindex}}{\noindent\csname professionalTraining\arabic{PTIkndex}\endcsname{PTIkndex}\par}}{}}
\newcommand{\training}{\iftoggle{EnglishToggle}{\section*{Professional Training}}{}\iftoggle{PersianToggle}{\section*{آموزش‌های حرفه‌ای}}{}\professionalTrainingListC}
